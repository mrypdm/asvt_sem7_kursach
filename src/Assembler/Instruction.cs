using System.Collections.Generic;
using System.Linq;

namespace Assembler;

internal record Instruction
{
    public static readonly Dictionary<string, Instruction> Instructions = new Instruction[]
    {
        new("clr", 0b0_000_101_000_000_000, 1),
        new("clrb", 0b1_000_101_000_000_000, 1),
        new("com", 0b0_000_101_001_000_000, 1),
        new("comb", 0b1_000_101_001_000_000, 1),
        new("inc", 0b0_000_101_010_000_000, 1),
        new("incb", 0b1_000_101_010_000_000, 1),
        new("dec", 0b0_000_101_011_000_000, 1),
        new("decb", 0b1_000_101_011_000_000, 1),
        new("neg", 0b0_000_101_100_000_000, 1),
        new("negb", 0b1_000_101_100_000_000, 1),
        new("tst", 0b0_000_101_111_000_000, 1),
        new("asr", 0b0_000_110_010_000_000, 1),
        new("asrb", 0b1_000_110_010_000_000, 1),
        new("tstb", 0b1_000_101_111_000_000, 1),
        new("asl", 0b0_000_110_011_000_000, 1),
        new("aslb", 0b1_000_110_011_000_000, 1),
        new("ror", 0b0_000_110_000_000_000, 1),
        new("rorb", 0b1_000_110_000_000_000, 1),
        new("rol", 0b0_000_110_001_000_000, 1),
        new("rolb", 0b1_000_110_001_000_000, 1),
        new("swab", 0b0_000_000_011_000_000, 1),
        new("adc", 0b0_000_101_101_000_000, 1),
        new("adcb", 0b1_000_101_101_000_000, 1),
        new("sbc", 0b0_000_101_110_000_000, 1),
        new("sbcb", 0b1_000_101_110_000_000, 1),
        new("sxt", 0b0_000_110_111_000_000, 1),
        new("mfps", 0b1_000_110_111_000_000, 1),
        new("mtps", 0b1_000_110_100_000_000, 1),
        new("mov", 0b0_001_000_000_000_000, 2),
        new("movb", 0b1_001_000_000_000_000, 2),
        new("cmp", 0b0_010_000_000_000_000, 2),
        new("cmpb", 0b1_010_000_000_000_000, 2),
        new("add", 0b0_110_000_000_000_000, 2),
        new("sub", 0b1_110_000_000_000_000, 2),
        new("bit", 0b0_011_000_000_000_000, 2),
        new("bitb", 0b1_011_000_000_000_000, 2),
        new("bic", 0b0_100_000_000_000_000, 2),
        new("bicb", 0b1_100_000_000_000_000, 2),
        new("bis", 0b0_101_000_000_000_000, 2),
        new("bisb", 0b1_101_000_000_000_000, 2),
        new("xor", 0b0_111_100_000_000_000, 2),
        new("br", 0b0_000_000_100_000_000, 1),
        new("bne", 0b0_000_001_000_000_000, 1),
        new("beq", 0b0_000_001_100_000_000, 1),
        new("bpl", 0b1_000_000_000_000_000, 1),
        new("bmi", 0b1_000_000_100_000_000, 1),
        new("bvc", 0b1_000_010_000_000_000, 1),
        new("bvs", 0b1_000_010_100_000_000, 1),
        new("bcc", 0b1_000_011_000_000_000, 1),
        new("bcs", 0b1_000_011_100_000_000, 1),
        new("bge", 0b0_000_010_000_000_000, 1),
        new("blt", 0b0_000_010_100_000_000, 1),
        new("bgt", 0b0_000_011_000_000_000, 1),
        new("ble", 0b0_000_011_100_000_000, 1),
        new("bhi", 0b1_000_001_000_000_000, 1),
        new("blos", 0b1_000_001_100_000_000, 1),
        new("bhis", 0b1_000_011_000_000_000, 1),
        new("blo", 0b1_000_011_100_000_000, 1),
        new("jmp", 0b0_000_000_001_000_000, 1),
        new("jsr", 0b0_000_100_000_000_000, 2),
        new("rts", 0b0_000_000_010_000_000, 1),
        new("mark", 0b0_000_110_100_000_000, 1),
        new("sob", 0b0_111_111_000_000_000, 2),
        new("bpt", 0b0_000_000_000_000_011, 0),
        new("iot", 0b0_000_000_000_000_100, 0),
        new("rti", 0b0_000_000_000_000_010, 0),
        new("rtt", 0b0_000_000_000_000_110, 0),
        new("halt", 0b0_000_000_000_000_000, 0),
        new("wait", 0b0_000_000_000_000_001, 0),
        new("reset", 0b0_000_000_000_000_101, 0),
        // Pseudo instructions
        new(".word", 0, -1),
        new(".blkw", 0, 1),
        new(".end", 0, 1)
    }.ToDictionary(m => m.Mnemonics, m => m);

    private Instruction(string mnemonics, int code, int argumentsCount)
    {
        Mnemonics = mnemonics;
        Code = code;
        ArgumentsCount = argumentsCount;
    }

    public string Mnemonics { get; }

    public int Code { get; }

    public int ArgumentsCount { get; }
}